<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <link rel="stylesheet" href="layui/css/layui.css" />
    <link rel="stylesheet" href="css/index.css">
    <script type="text/javascript" src="layui/layui.js"></script>
    <script type="text/javascript" src="js/config.js"></script>
    <div class="table">
        <table id="myPost" lay-filter="myPost"></table>
    </div>
    <script type="text/html" id="toolbarDemo">
        <div class="layui-btn-container operationButton">
            <button class="layui-btn layui-btn-sm" lay-event="add" id="add">添加</button>
        </div>
        <div class="searchDiv">
            <input class="layui-input input" id="input">
            <button class="layui-icon layui-icon-search search" id="search"></button>
        </div>
    </script>
    <script>
        layui.use(['jquery', 'element', 'form', 'table', 'upload'], function () {
            var $ = layui.jquery,
                form = layui.form,
                table = layui.table,
                upload = layui.upload;
            var username = window.sessionStorage.getItem("username");
            var res;
            table.render({
                elem: '#myPost'
                , toolbar: '#toolbarDemo'
                , parseData: function (res) { //res 即为原始返回的数据
                    return {
                        "code": res.responseCode, //解析接口状态
                        "count": res.count,
                        "data": res.data
                    };
                }
                , height: 522
                , url: 'post/myPost?username=' + username //数据接口
                , id: 'myPost'
                , page: true //开启分页
                , cols: [[ //表头
                    { field: 'post', title: '岗位名称', align: 'center', edit: 'text' },
                    { field: 'workplace', title: '工作地点', align: 'center', edit: 'text' },
                    { field: 'pay', title: '月薪', align: 'center', sort: true, edit: 'text' },
                    { field: 'workDescribe', title: '描述', align: 'center', edit: 'text' },
                    { field: 'recruitingNumber', title: '招聘人数', align: 'center', sort: true, edit: 'text' },
                    { field: 'postType', title: '岗位类型', align: 'center', edit: 'text' },
                ]]
            });
            table.on('edit(myPost)', function (obj) { //注：edit是固定事件名，test是table原始容器的属性 lay-filter="对应的值"
                console.log(obj.value); //得到修改后的值
                console.log(obj.field); //当前编辑的字段名
                console.log(obj.data); //所在行的所有相关数据  
                var id = obj.data.id,
                    field = obj.field,
                    value = obj.value;
                // var str='trade/updateGoods?id=' + id + '&' + field + '=' + value;
                // console.log(str)
                $.get('post/updatePost?id=' + id + '&' + field + '=' + value, function (res) {
                    console.log(res);
                });
            });
            $(document).on('click', '#search', function (res) {
                var keyWord = document.getElementById('input').value;
                table.reload('myPost', ({
                    elem: '#myPost'
                    , toolbar: '#toolbarDemo'
                    , parseData: function (res) { //res 即为原始返回的数据
                        return {
                            "code": res.responseCode, //解析接口状态
                            "count": res.count,
                            "data": res.data
                        };
                    }
                    , height: 522
                    , url: 'post/myPost?username=' + username + '&keyWord=' + keyWord //数据接口
                    , id: 'myPost'
                    , page: true //开启分页
                    , cols: [[ //表头
                        { field: 'post', title: '岗位名称', align: 'center', edit: 'text' },
                        { field: 'workplace', title: '工作地点', align: 'center', edit: 'text' },
                        { field: 'pay', title: '月薪', align: 'center', sort: true, edit: 'text' },
                        { field: 'workDescribe', title: '描述', align: 'center', edit: 'text' },
                        { field: 'recruitingNumber', title: '招聘人数', align: 'center', sort: true, edit: 'text' },
                        { field: 'postType', title: '岗位类型', align: 'center', edit: 'text' },
                    ]]
                }))
            });
        });
    </script>
</body>

</html>